
select t.Request_at as Day,round(sum(case when t.Status='completed' then 0 else 1 end)/count(t.Status),2) as 'Cancellation Rate'
from Trips as t
left join Users a on (t.Client_Id=a.Users_Id and a.Banned ='No')
left join Users b on (t.Driver_Id=b.Users_Id and b.Banned ='No')
where t.Request_at between '2013-10-01' and '2013-10-03'
group by t.Request_at order by t.Request_at